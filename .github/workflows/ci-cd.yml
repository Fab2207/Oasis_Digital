name: CI-CD - Spring Boot Maven

on:
  push:
    branches:
      - main
      - develop
  pull_request:
    branches:
      - main
      - develop

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout del código
        uses: actions/checkout@v4

      - name: Configurar JDK 17
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: '17'
          cache: maven

      - name: Validar y compilar (mvn verify)
        run: mvn -B clean verify

      - name: Empaquetar aplicación (mvn package)
        run: mvn -B package -DskipTests

      # Ejemplo opcional: subir el JAR como artefacto del pipeline
      - name: Publicar artefacto (JAR)
        uses: actions/upload-artifact@v4
        with:
          name: sistema-hotelero-jar
          path: target/*.jar

  # Job de "deploy" de ejemplo (ajusta según tu entorno real)
  deploy:
    needs: build-and-test
    runs-on: ubuntu-latest
    if: github.ref == 'refs/heads/main'

    steps:
      - name: Checkout del código
        uses: actions/checkout@v4

      # Aquí iría tu lógica real de despliegue
      # Por ejemplo, construir y subir una imagen Docker, o hacer deploy a un servidor
      - name: Paso de despliegue (placeholder)
        run: echo "Aquí iría el script real de deploy (Docker, servidor, etc.)"
